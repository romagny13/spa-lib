/*!
 * SpaLib v0.0.7
 * (c) 2017 romagny13
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.SpaLib=t.SpaLib||{})}(this,function(t){"use strict";function e(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function r(t){return"undefined"==typeof t}function n(t){return"undefined"!=typeof t}function o(t){return"string"==typeof t}function i(t){return"number"==typeof t}function s(t){return null!==t&&"object"==typeof t}function c(t){return"function"==typeof t}function u(t){return"boolean"==typeof t}function a(t){var e=new Date;return e.setTime(e.getTime()+24*t*60*60*1e3),e.toUTCString()}function f(t){try{var e=JSON.parse(t);return e}catch(t){return null}}function h(){return void 0!==typeof Storage}function l(){var t=window;return t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.msIndexedDB}function p(t,e){t.onerror=function(t){e(t)},t.onblocked=function(t){e(t)},t.onabort=function(t){e(t)}}function d(t){return t instanceof HTMLFormElement}function v(t){var e=t.toLocaleLowerCase();return"lostfocus"===e||"valuechanged"===e}function g(t){var e=t.toLocaleLowerCase();return"submit"===e||"valuechanged"===e}function y(t){return o(t)?document.querySelector(t):d(t)?t:void 0}function m(t){return"INPUT"===t.tagName?"checkbox"===t.type?G.CheckBox:"radio"===t.type?G.Radio:"range"===t.type?G.Range:G.Input:"TEXTAREA"===t.tagName?G.TextArea:"SELECT"===t.tagName?G.Select:G.Other}function b(t,e){return"string"===t?String(e):"number"===t?Number(e):"boolean"===t?Boolean(e):void 0}function _(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName}function w(t){return t!==G.CheckBox&&t!==G.Radio&&t!==G.Range}function E(t,e,r){return _(t)?"lostfocus"===r?["change"]:w(e)?["keyup","change"]:["change"]:[]}function C(t,e,r,n){if(n===G.Input||n===G.TextArea)t.value=r;else if(n===G.CheckBox)"boolean"===e?t.checked=r:t.checked=t.value===r;else if(n===G.Radio)t.checked=t.value===r;else if(n===G.Select){for(var o=t.options,i=0;i<o.length;i++)if(o[i].value===r){t.selectedIndex=i;break}}else t.innerHTML=r}function S(t,e){return e===G.Input?t.value:e===G.CheckBox||e===G.Radio?t.checked:e===G.Select?t.options[t.selectedIndex].value:e===G.Range?t.value:e===G.TextArea?t.value:void 0}function k(t,e,r,n){t.forEach(function(t){var o="boolean"===e?r.checked:b(e,r.value);o===t&&C(r,e,o,n)})}function T(t,e,r,n,o){if(r){var i=t.parentNode.querySelector(".help-block");i||(i=document.createElement("span"),i.classList.add("help-block"),t.parentNode.appendChild(i)),i.innerHTML=e[0]}n&&t.parentNode.classList.remove("has-success"),o&&t.parentNode.classList.add("has-error")}function O(t,e,r,n){if(e){var o=t.parentNode.querySelector(".help-block");o&&t.parentNode.removeChild(o)}r&&t.parentNode.classList.remove("has-error"),n&&t.parentNode.classList.add("has-success")}function R(t,e){var r=[];return e.forEach(function(e){e.validate(t)||r.push(e.error)}),r}function x(t){return t.getAttribute("name")}function j(t,e,r,n,o){e.length>0?T(t,e,r,n,o):O(t,r,n,o)}function D(t,e,r,n,o){var i=new Q(t,e),s=typeof t[e];i.subscribe(function(t){C(r,s,t,n),o(t)})}function N(t,e,r,n){var o=new W(t);o.subscribe(function(t,e,r){"added"!==t&&"removed"!==t||n(t,e,r)})}function P(t,e,r,n){var o=E(t,e,r);o.forEach(function(e){t.addEventListener(e,n)})}function U(t,e,r){return t.replace(e,r)}function q(){return new XMLHttpRequest}function A(t,e,r,n){var o=new dt({method:t,url:e});return r&&(o.addHeader("content-type","application/json"),o.data=r),n&&o.addHeader("Authorization","Bearer "+n),o}function L(t){var e={},r=t.trim().split("\r\n");return r.forEach(function(t){var r=t.split(": ");r[1]&&(e[r[0]]=r[1])}),e}function I(t,e){var r=[];return e.forEach(function(e){c(e[t])&&r.push(e[t])}),r}function B(t,e){var r=new vt;return r.status=t.status,r.headers=L(t.getAllResponseHeaders()),r.content=e.responseType?t.response:t.responseText,r}function V(t,e){var r=q();if(!r)throw new Error("XMLHttpRequest not supported");if(r.open(t.method,t.url,t.async),t.headers)for(var n in t.headers)r.setRequestHeader(n,t.headers[n]);t.responseType&&(r.responseType=t.responseType),r.onreadystatechange=function(){4===r.readyState&&e(B(r,t))},r.send(t.data)}function H(t,e){t._result=e;var r=t._stack.next(Y.onResolved);r?r.fn():t._state=wt.waitOnResolvedCallback}function M(t,e){t._reason=e;var r=t._stack.next(Y.onRejected);r?r.fn():t._state=wt.waitOnRejectedCallback}function F(t,e,r,n){function o(){try{var n=r(t._result);e._child.resolve(n)}catch(t){e._child.reject(t)}}function i(){try{var r=n(t._reason);e._child.resolve(r)}catch(t){e._child.reject(t)}}var s=c(r),u=c(n);if(e._child=new Tt(t),s&&t._stack.push(Y.onResolved,function(){o()}),u&&t._stack.push(Y.onRejected,function(){i()}),s&&t._state===wt.waitOnResolvedCallback){var a=t._stack.next(Y.onResolved);a&&a.fn()}else if(u&&t._state===wt.waitOnRejectedCallback){var a=t._stack.next(Y.onRejected);a&&a.fn()}return e._child}var G,X=Array.isArray,$=function(){function t(){}return t.prototype.set=function(t,e,r){if(!o(t))throw new Error("Name required");if(!o(e))throw new Error("String value required");i(r)||(r=30),document.cookie=t+"="+e+";expires="+a(r)},t.prototype.get=function(t){if(!o(t))throw new Error("Name required");for(var e=document.cookie.split(";"),r=0;r<e.length;r++){var n=e[r].split("=");if(n[0].trim()===t)return n[1].trim()}},t.prototype.has=function(t){if(!o(t))throw new Error("Name required");return void 0!==this.get(t)},t.prototype.delete=function(t){return!!this.has(t)&&(this.set(t,"",-1),!0)},t.prototype.clear=function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var r=t[e].split("=")[0];this.set(r,"",-1)}},t}(),z=function(){function t(t){this._indexedDB=l(),this._dbConfigs=n(t)&&t||[]}return t.prototype.getDbConfig=function(t){return this._dbConfigs.find(function(e){return e.name===t})},t.prototype.openCreateDb=function(t,e){var r=this;return new Promise(function(n,o){var i=r._indexedDB.open(t,e);p(i,o),i.onupgradeneeded=function(e){var n=e.target.result,o=r.getDbConfig(t);o&&X(o.objectStores)&&o.objectStores.forEach(function(t){n.objectStoreNames.contains(t.name)||r.createObjectStore(n,t.name,t.key,t.indexes)})},i.onsuccess=function(e){r._currentDb=e.target.result,r._currentDbName=t,r._currentConfig=r.getDbConfig(t),n(r._currentDb)}})},t.prototype.closeDb=function(){this._currentDb&&"close"in this._currentDb&&this._currentDb.close()},t.prototype.deleteDb=function(t){var e=this;return new Promise(function(r,n){e._currentDbName===t&&e.closeDb();var o=e._indexedDB.deleteDatabase(t);p(o,n),o.onsuccess=function(t){r(t)}})},t.prototype.createObjectStore=function(t,e,r,n){var o=t.createObjectStore(e,r);n&&n.forEach(function(t){var e=t.definition||{unique:!1};o.createIndex(t.name,t.key,e)})},t.prototype.getObjectStore=function(t,e,r){var n=this._currentDb.transaction([t],e);return r&&p(n,r),n.objectStore(t)},t.prototype.insert=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");if(r._currentConfig&&r._currentConfig.created){var i=Date.now();e.created=i,e.modified=i}var s=r.getObjectStore(t,"readwrite",o);if(s){var c=s.add(e);p(c,o),c.onsuccess=function(t){n(t.target.result)}}})},t.prototype.update=function(t,e,r){var n=this;return new Promise(function(o,i){if(!n._currentDb)throw new Error("Require a connection opened");var s=n.getObjectStore(t,"readwrite",i),c=s.get(e);p(c,i),c.onsuccess=function(t){var e=t.target.result;if(e){n._currentConfig&&n._currentConfig.created&&(r.modified=Date.now());var c=s.put(r);p(c,i),c.onsuccess=function(){o(r)}}}})},t.prototype.delete=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");var i=r.getObjectStore(t,"readwrite",o),s=i.delete(e);p(s,o),s.onsuccess=function(t){n(t)}})},t.prototype.count=function(t){var e=this;return new Promise(function(r,n){if(!e._currentDb)throw new Error("Require a connection opened");var o=e.getObjectStore(t,"readonly",n),i=o.count();p(i,n),i.onsuccess=function(t){r(t.target.result)}})},t.prototype.getAll=function(t){var e=this;return new Promise(function(r,n){if(!e._currentDb)throw new Error("Require a connection opened");var o=[],i=e.getObjectStore(t,"readonly",n),s=i.count();p(s,n),s.onsuccess=function(t){var e=t.target.result,s=i.openCursor();p(s,n),s.onsuccess=function(t){var n=t.target.result;if(n){var i=n.value;o.push(i),o.length===e?r(o):n.continue()}else r(o)}}})},t.prototype.getOne=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");var i=r.getObjectStore(t,"readonly",o),s=i.get(e);p(s,o),s.onsuccess=function(t){n(t.target.result)}})},t}(),J=function(){function t(t){this._strategy=o(t)&&/^(local|session)$/i.test(t)?t:"local","local"===this._strategy?this._storage=localStorage:this._storage=sessionStorage}return t.prototype.set=function(t,e){try{var r=s(e)?JSON.stringify(e):e;this._storage[t]=r}catch(t){}},t.prototype.get=function(t){var e=this._storage[t],r=f(e);return r?r:e},t.prototype.has=function(t){return void 0!==this._storage[t]},t.prototype.remove=function(t){return!!this.has(t)&&(this._storage.removeItem(t),!0)},t.prototype.getValues=function(){for(var t=[],e=0;e<this._storage.length;e++){var r=this.get(this._storage.key(e));t.push(r)}return t},t.prototype.getKeys=function(){return Object.keys(this._storage)},t.prototype.clear=function(){this._storage.clear()},t}(),K=function(){var t={},e=new J,r=function(){function r(){}return Object.defineProperty(r.prototype,"length",{get:function(){return Object.keys(t).length},enumerable:!0,configurable:!0}),r.prototype.has=function(e){return t.hasOwnProperty(e)},r.prototype.store=function(e,r){t[e]=r},r.prototype.retrieve=function(e){if(this.has(e))return t[e]},r.prototype.remove=function(e){return!!this.has(e)&&(delete t[e],!0)},r.prototype.clear=function(){t={}},r.prototype.save=function(r){e.set(r,t)},r.prototype.restore=function(r){var n=e.get(r);return!!n&&(t=n,!0)},r}();return r}(),Q=function(){function t(t,e){function r(t){o._subscribers.forEach(function(e){e(t)})}var n=t[e],o=this;this._subscribers=[],Object.defineProperty(t,e,{get:function(){return n},set:function(t){n=t,r(t)},enumerable:!0,configurable:!0})}return t.prototype.subscribe=function(t){this._subscribers.push(t)},t.prototype.unsubscribe=function(t){var e=this._subscribers.indexOf(t);return e!==-1&&(this._subscribers.splice(e,1),!0)},t}(),W=function(){function t(t){function e(t,e,r){n._subscribers.forEach(function(n){n(t,e,r)})}var n=this;if(!X(t))throw new TypeError("Array required");this._subscribers=[],this._array=t,t.push=function(){for(var r=0;r<arguments.length;r++){var n=arguments[r],o=t.length;Array.prototype.push.call(t,n),e("added",n,o)}return t.length},t.unshift=function(){for(var r=0;r<arguments.length;r++){var n=arguments[r];t.splice(r,0,n),e("added",n,r)}return t.length},t.splice=function(t,n){for(var o=this,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var c=[];if(r(t)||r(n))return c;for(;n--;){var u=n+t,a=Array.prototype.splice.call(this,u,1)[0];e("removed",a,u)}return i.forEach(function(r,n){Array.prototype.splice.call(o,t,0,r),e("added",r,n),t++}),c},t.shift=function(){if(t.length>-1){var r=Array.prototype.shift.call(this);return e("removed",r,0),r}},t.pop=function(){var r=t.length-1;if(r>-1){var n=Array.prototype.pop.call(this);return e("removed",n,r),n}},t.sort=function(r){return Array.prototype.sort.call(this,r),e("sorted",t,null),t},t.filter=function(r){var n=[];return t.forEach(function(t){r(t)&&n.push(t)}),e("filtered",n,null),n},t.resetFilter=function(){return e("filtered",t,null),t}}return t.prototype.subscribe=function(t){this._subscribers.push(t)},t.prototype.unsubscribe=function(t){var e=this._subscribers.indexOf(t);return e!==-1&&(this._subscribers.splice(e,1),!0)},t}();!function(t){t[t.CheckBox=0]="CheckBox",t[t.Radio=1]="Radio",t[t.Input=2]="Input",t[t.Range=3]="Range",t[t.Select=4]="Select",t[t.TextArea=5]="TextArea",t[t.Other=6]="Other"}(G||(G={}));var Y,Z=function(){function t(t,e){if(!o(t))throw new Error("Name required (target form element name/source property name)");this.name=t,this.validators=[];var r=o(e)?e:"valuechanged";this.setUpdateType(r)}return t.prototype.setUpdateType=function(t){if(!o(t))throw new Error("Update type required");if(!v(t))throw new Error("Invalid update type (valuechanged|lostfocus)");return this.updateType=t,this},t.prototype.addValidator=function(t){return this.validators.push(t),this},t}(),tt=function(){function t(t,e,r,n){this.validationType=o(t)&&g(t)?t:"submit",this.formElementConfigs={},this.showErrorMessages=!u(e)||e,this.cssClassOnSuccess=!u(r)||r,this.cssClassOnError=!u(n)||n}return t.prototype.addFormElementConfig=function(t){return this.formElementConfigs[t.name]=t,this},t.prototype.getFormElementConfig=function(t){if(this.formElementConfigs.hasOwnProperty(t))return this.formElementConfigs[t]},t}(),et=function(){function t(t,e,r,n,o){this.formBinding=t,this.element=e,this.bindedName=r,this.formElementConfig=n,this.formConfig=o,this._subscribers=[],this._elementType=m(e)}return t.prototype._raiseStateChanged=function(t,e){this._subscribers.forEach(function(r){r(t,e)})},t.prototype._checkState=function(t,e){var r=t[0],n=o(r);this.hasError===n&&this.firstError===r||(this.hasError=n,this.firstError=r,this.errors=t,this._raiseStateChanged(this.element,t),e())},t.prototype.onStateChanged=function(t){this._subscribers.push(t)},t}(),rt=function(t){function r(e,r,n,o,i,s,c,u){var a=t.call(this,e,r,n,o,i)||this;return a.source=s,a.sourceValue=c,a.type=u,a._bind(a.element,a._elementType,a.source,a.bindedName,a.sourceValue,a.type,a.formElementConfig,a.formConfig),a}return e(r,t),r.prototype._bind=function(t,e,r,n,o,i,s,c){var u,a=this;P(t,e,s.updateType,function(t){var e="boolean"===i?t.target.checked:b(i,t.target.value);r[n]=e}),D(r,n,t,e,function(e){if(u||a.formBinding.canValidate){var r=R(e,s.validators);a._checkState(r,function(){j(t,r,c.showErrorMessages,c.cssClassOnSuccess,c.cssClassOnError)}),u=!0}}),C(t,i,o,e)},r.prototype.validate=function(){var t=this.source[this.bindedName];return this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(et),nt=function(t){function r(e,r,n,o,i,s,c){var u=t.call(this,e,r,n,o,i)||this;return u.source=s,u.sourceValue=c,u.type=c[0]?typeof c[0]:"string",u._bind(u.element,u._elementType,u.sourceValue,u.type,u.formElementConfig,u.formConfig),u}return e(r,t),r.prototype._bind=function(t,e,r,n,o,i){var s,c=this;P(t,e,o.updateType,function(t){var e="boolean"===n?t.target.checked:b(n,t.target.value),o=r.indexOf(e);o===-1?r.push(e):r.splice(o,1)}),N(r,t,e,function(u,a,f){if(k(r,n,t,e),s||c.formBinding.canValidate){var h=R(a,o.validators);c._checkState(h,function(){j(t,h,i.showErrorMessages,i.cssClassOnSuccess,i.cssClassOnError)}),s=!0}}),k(r,n,t,e)},r.prototype.validate=function(){var t=this.source[this.bindedName];return this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(et),ot=function(t){function r(e,r,n,o,i){var s=t.call(this,e,r,n,o,i)||this;return s._bind(s.element,s._elementType,s.formElementConfig,s.formConfig),s}return e(r,t),r.prototype._bind=function(t,e,r,n){var o,i=this;P(t,e,r.updateType,function(e){if(o||i.formBinding.canValidate){var s=S(t,i._elementType);i.value=s;var c=R(s,r.validators);i._checkState(c,function(){j(t,c,n.showErrorMessages,n.cssClassOnSuccess,n.cssClassOnError)}),o=!0}})},r.prototype.validate=function(){var t=S(this.element,this._elementType);return this.value=t,this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(et),it=function(){function t(t,e,r){this.element=t,this.message=e,this.value=r}return t}(),st=function(){function t(t,e,r,n){this.hasError=t,this.errors=e,this.form=r,this.source=n}return t}(),ct=function(){function t(t,e,r){this._subscribers=[],this._stateSubscribers=[],this._bindings=[],this.submitted=!1;var o=y(t);if(!o)throw new Error("No element found for the form");this.form=o,this.source=e,this.formConfig=n(r)?r:new tt,this.validationType=r.validationType,this._bind(o,e,this.formConfig),this._bindSubmit(o,e,this.formConfig)}return Object.defineProperty(t.prototype,"canValidate",{get:function(){return this.submitted||"valuechanged"===this.validationType},enumerable:!0,configurable:!0}),t.prototype._bind=function(t,e,r){for(var n=this,o=0;o<t.elements.length;o++){var i=t.elements[o];if("submit"!==i.type){var s=_(i),c=x(i);if(s&&c){var u=r.getFormElementConfig(c);if(e&&e.hasOwnProperty(c)){var a=e[c],f=typeof a;if(u||(u=new Z(c),r.addFormElementConfig(u)),"string"===f||"number"===f||"boolean"===f){var h=new rt(this,i,c,u,r,e,a,f);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}else if(X(a)){var h=new nt(this,i,c,u,r,e,a);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}}else if(Z){var h=new ot(this,i,c,u,r);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}}}}},t.prototype._validateAll=function(t,e,r){var n=!1,o=[],i={};this._bindings.forEach(function(t){if(!i.hasOwnProperty(t.bindedName)){var e=t instanceof rt?t.sourceValue:t.value,s=t.validate();s.length>0&&(n=!0,o.push(new it(t.element,s[0],e))),j(t.element,s,r.showErrorMessages,r.cssClassOnSuccess,r.cssClassOnError),i[t.bindedName]="validated"}}),this.submitted=!0;var s=new st(n,o,this.form,this.source);this._raise(s)},t.prototype._bindSubmit=function(t,e,r){var n=this;t.addEventListener("submit",function(o){o.preventDefault(),n._validateAll(t,e,r)})},t.prototype._raise=function(t){this._subscribers.forEach(function(e){e(t)})},t.prototype._raiseStateChanged=function(t,e){this._validateAll(this.form,this.source,this.formConfig),this._stateSubscribers.forEach(function(r){r(t,e)})},t.prototype.onStateChanged=function(t){this._stateSubscribers.push(t)},t.prototype.onSubmit=function(t){this._subscribers.push(t)},t}(),ut=function(){function t(){}return t}(),at=function(t){function n(e){var r=t.call(this)||this;return r.message=o(e)?e:"This field is required.",r}return e(n,t),n.prototype.validate=function(t){return null===t||r(t)||""===t||u(t)&&t===!1?(this.error=this.message,!1):(this.error=void 0,!0)},n}(ut),ft=function(t){function r(e,r){var n=t.call(this)||this;return n.minLength=i(e)?e:3,n.message=o(r)?r:U("Please enter at least than {0} characters.","{0}",e),n}return e(r,t),r.prototype.validate=function(t){return t&&t.length<this.minLength?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ut),ht=function(t){function r(e,r){var n=t.call(this)||this;return n.maxLength=i(e)?e:30,n.message=o(r)?r:U("Please enter no more than {0} characters.","{0}",e),n}return e(r,t),r.prototype.validate=function(t){return t&&t.length>this.maxLength?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ut),lt=function(t){function r(e,r){var n=t.call(this)||this;return n.pattern=e,n.message=o(r)?r:"Please fix this field.",n}return e(r,t),r.prototype.validate=function(t){return n(t)&&!this.pattern.test(t)?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ut),pt=function(t){function r(e,r){var n=t.call(this)||this;return n.fn=e,n.message=o(r)?r:"Please fix this field.",n}return e(r,t),r.prototype.validate=function(t){return this.fn(t)?(this.error=void 0,!0):(this.error=this.message,!1)},r}(ut),dt=function(){function t(t){if(!o(t.url))throw new Error("Url required");if(this.headers={},t.headers)for(var e in t.headers)this.addHeader(e,t.headers[e]);this.url=t.url,this.method=o(t.method)&&/^(GET|POST|PUT|DELETE|HEAD|OPTIONS|PATCH)$/i.test(t.method)?t.method:"GET",this.async=!u(t.async)||t.async,this.data=n(t.data)?t.data:null,t.responseType&&(this.responseType=t.responseType)}return t.prototype.addHeader=function(t,e){return this.headers[t]=e,this},t.prototype.setResponseType=function(t){return this.responseType=t,this},t}(),vt=function(){function t(){}return Object.defineProperty(t.prototype,"isSuccessStatusCode",{get:function(){return/^(200|201|202|203|204|205|206|304)$/.test(this.status.toString())},enumerable:!0,configurable:!0}),t}(),gt=function(){function t(){this.interceptors=[]}return t.prototype.intercept=function(t,e,r,n){function o(t){t(e,function(t){t?(c++,c<s?o(i[c]):r()):n()})}var i=I(t,this.interceptors),s=i.length,c=0;s>0?o(i[0]):r&&r()},t.prototype.load=function(t,e,n){if(r(t))throw new Error("Url required");var o=new dt({url:t});V(o,function(t){200===t.status?e(t.content):n&&n(t)})},t.prototype.send=function(t){var e=this;return new Promise(function(r,n){e.intercept("before",t,function(){try{V(t,function(t){e.intercept("after",t,function(){t.isSuccessStatusCode?r(t):n(t)},function(){n(t)})})}catch(t){n(t)}},function(){var t=new vt;t.status=401,n(t)})})},t.prototype.get=function(t,e){var r=A("GET",t,null,e);return this.send(r)},t.prototype.post=function(t,e,r){var n=A("POST",t,e,r);return this.send(n)},t.prototype.put=function(t,e,r){var n=A("PUT",t,e,r);return this.send(n)},t.prototype.delete=function(t,e){var r=A("DELETE",t,null,e);return this.send(r)},t}(),yt=function(){function t(){this._cache={}}return t.prototype.getSubscribers=function(t){return this._cache[t]},t.prototype.isRegistered=function(t){return this._cache.hasOwnProperty(t)},t.prototype.subscribe=function(t,e){if(r(t))throw new Error("Event required");if(r(e))throw new Error("Subscriber required");this.isRegistered(t)||(this._cache[t]=[]),this._cache[t].push(e)},t.prototype.publish=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.isRegistered(t)&&this._cache[t].forEach(function(t){t.apply(void 0,e)})},t.prototype.unsubscribe=function(t,e){if(r(t))throw new Error("Event required");if(this.isRegistered(t)){if(!c(e))return delete this._cache[t],!0;var n=this._cache[t].indexOf(e);if(n!==-1)return this._cache[t].splice(n,1),!0}return!1},t.prototype.clear=function(){this._cache={}},t}(),mt=function(){function t(t){if(r(t))throw new Error("Config required");if(r(t.clientId))throw new Error("clientId required");if(r(t.redirectUrl))throw new Error("redirectUrl required");this._http=new gt,this.clientId=t.clientId,this.redirectUrl=t.redirectUrl}return t.prototype.getCodeUrl=function(){if(r(this.authUrl))throw new Error("authUrl required");return this.authUrl+"?client_id="+this.clientId+"&redirect_uri="+this.redirectUrl+"&scope="+this.scope+"&response_type=code"},t.prototype.getProfile=function(t){var e=this;if(r(t))throw new Error("access_token required");if(r(this.profileUrl))throw new Error("profileUrl required");var n=r(this.fields)?this.profileUrl:this.profileUrl+"?fields="+this.fields;return new Promise(function(r,o){e._http.get(n,t).then(function(t){r(t.content)}).catch(function(t){o(t)})})},t.prototype.getTokenUrl=function(){if(r(this.authUrl))throw new Error("authUrl required");return this.authUrl+"?client_id="+this.clientId+"&redirect_uri="+this.redirectUrl+"&scope="+this.scope+"&response_type=token"},t}(),bt=function(t){function r(e){var r=t.call(this,e)||this;return r.scope=e.scope||"public_profile,email",r.authUrl=e.authUrl||"https://www.facebook.com/dialog/oauth",r.profileUrl=e.profileUrl||"https://graph.facebook.com/me",r.fields=e.fields||"id,name,email",r}return e(r,t),r}(mt),_t=function(t){function r(e){var r=t.call(this,e)||this;return r.scope=e.scope||"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",r.authUrl=e.authUrl||"https://accounts.google.com/o/oauth2/auth",r.profileUrl=e.profileUrl||"https://www.googleapis.com/oauth2/v1/userinfo",r}return e(r,t),r}(mt);!function(t){t[t.onResolved=0]="onResolved",t[t.onRejected=1]="onRejected"}(Y||(Y={}));var wt,Et=function(){function t(t,e){this.type=t,this.fn=e}return t}(),Ct=function(){function t(){this._stack=[]}return t.prototype._getNextItemIndex=function(t){for(var e=this._stack.length,r=0;r<e;r++){var n=this._stack[r];if(n.type===t)return r}return-1},t.prototype._splice=function(t){this._stack.splice(0,t)},t.prototype.clear=function(){this._stack=[]},t.prototype.push=function(t,e){this._stack.push(new Et(t,e))},t.prototype.next=function(t){var e=this._getNextItemIndex(t);return e!==-1?this._splice(e):this.clear(),this._stack.shift()},t}();!function(t){t[t.completed=0]="completed",t[t.waitOnResolvedCallback=1]="waitOnResolvedCallback",t[t.waitOnRejectedCallback=2]="waitOnRejectedCallback"}(wt||(wt={}));var St=function(){function t(){}return t}(),kt=function(t){function r(e){var r=t.call(this)||this;r._stack=new Ct;try{c(e)&&e(function(t){r.resolve(t)},function(t){r.reject(t)})}catch(t){r.reject(t)}return r}return e(r,t),r.prototype.resolve=function(t){H(this,t)},r.prototype.reject=function(t){M(this,t)},r.prototype.then=function(t,e){return F(this,this,t,e)},r.prototype.catch=function(t){return F(this,this,null,t)},r.all=function(t){for(var e=[],n=!1,o=t.length,i=0,s=new r,c=0;c<o;c++){var u=t[c];try{u.then(function(t){n||(e.push(t),i++,i===o&&(n=!0,s.resolve(e)))},function(t){n||(n=!0,s.reject(t))})}catch(t){n=!0,s.reject(t)}}return s},r.race=function(t){for(var e=!1,n=t.length,o=new r,i=0;i<n;i++){var s=t[i];try{s.then(function(t){e||(e=!0,o.resolve(t))},function(t){e||(e=!0,o.reject(t))})}catch(t){e=!0,o.reject(t)}}return o},r}(St),Tt=function(t){function r(e){var r=t.call(this)||this;return r._root=e,r}return e(r,t),r.prototype.resolve=function(t){H(this._root,t)},r.prototype.reject=function(t){M(this._root,t)},r.prototype.then=function(t,e){return F(this._root,this,t,e)},r.prototype.catch=function(t){return F(this._root,this,null,t)},r}(St);t.Cache=K,t.FormBinding=ct,t.CustomValidator=pt,t.FormConfig=tt,t.FormElementConfig=Z,t.MaxLengthValidator=ht,t.MinLengthValidator=ft,t.PatternValidator=lt,t.RequiredValidator=at,t.Validator=ut,t.FormSubmittedResponse=st,t.FormElementError=it,t.Http=gt,t.HttpRequest=dt,t.HttpResponse=vt,t.Messenger=yt,t.Observable=Q,t.ObservableArray=W,t.FacebookAuth=bt,t.GoogleAuth=_t,t.OAuth=mt,t.TSPromise=kt,t.IndexedDBService=z,t.StorageService=J,t.CookieService=$,t.supportStorage=h,Object.defineProperty(t,"__esModule",{value:!0})});