/*!
 * SpaLib v0.1.2
 * (c) 2017 romagny13
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.SpaLib=t.SpaLib||{})}(this,function(t){"use strict";function e(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function r(t){return"undefined"==typeof t}function n(t){return"undefined"!=typeof t}function o(t){return"string"==typeof t}function i(t){return"number"==typeof t}function s(t){return null!==t&&"object"==typeof t}function u(t){return"function"==typeof t}function c(t){return"boolean"==typeof t}function a(t){var e=new Date;return e.setTime(e.getTime()+24*t*60*60*1e3),e.toUTCString()}function f(t){try{var e=JSON.parse(t);return e}catch(t){return null}}function h(){return void 0!==typeof Storage}function l(){var t=window;return t.indexedDB||t.webkitIndexedDB||t.mozIndexedDB||t.msIndexedDB}function p(t,e){t.onerror=function(t){e(t)},t.onblocked=function(t){e(t)},t.onabort=function(t){e(t)}}function d(t){return t instanceof HTMLFormElement}function v(t){var e=t.toLocaleLowerCase();return"lostfocus"===e||"valuechanged"===e}function g(t){var e=t.toLocaleLowerCase();return"submit"===e||"valuechanged"===e}function y(t){return o(t)?document.querySelector(t):d(t)?t:void 0}function m(t){return"INPUT"===t.tagName?"checkbox"===t.type?z.CheckBox:"radio"===t.type?z.Radio:"range"===t.type?z.Range:z.Input:"TEXTAREA"===t.tagName?z.TextArea:"SELECT"===t.tagName?z.Select:z.Other}function b(t,e){return"string"===t?String(e):"number"===t?Number(e):"boolean"===t?Boolean(e):void 0}function _(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName}function w(t){return t!==z.CheckBox&&t!==z.Radio&&t!==z.Range}function E(t,e,r){return _(t)?"lostfocus"===r?["change"]:w(e)?["keyup","change"]:["change"]:[]}function C(t,e,r,n){if(n===z.Input||n===z.TextArea)t.value=r;else if(n===z.CheckBox)"boolean"===e?t.checked=r:t.checked=t.value===r;else if(n===z.Radio)t.checked=t.value===r;else if(n===z.Select){for(var o=t.options,i=0;i<o.length;i++)if(o[i].value===r){t.selectedIndex=i;break}}else t.innerHTML=r}function S(t,e){return e===z.Input?t.value:e===z.CheckBox||e===z.Radio?t.checked:e===z.Select?t.options[t.selectedIndex].value:e===z.Range?t.value:e===z.TextArea?t.value:void 0}function T(t,e,r,n){t.forEach(function(t){var o="boolean"===e?r.checked:b(e,r.value);o===t&&C(r,e,o,n)})}function O(t,e,r,n,o){if(r){var i=t.parentNode.querySelector(".help-block");i||(i=document.createElement("span"),i.classList.add("help-block"),t.parentNode.appendChild(i)),i.innerHTML=e[0]}n&&t.parentNode.classList.remove("has-success"),o&&t.parentNode.classList.add("has-error")}function k(t,e,r,n){if(e){var o=t.parentNode.querySelector(".help-block");o&&t.parentNode.removeChild(o)}r&&t.parentNode.classList.remove("has-error"),n&&t.parentNode.classList.add("has-success")}function R(t,e){var r=[];return e.forEach(function(e){e.validate(t)||r.push(e.error)}),r}function x(t){return t.getAttribute("name")}function j(t,e,r,n,o){e.length>0?O(t,e,r,n,o):k(t,r,n,o)}function P(t,e,r,n,o){var i=new Y(t,e),s=typeof t[e];i.subscribe(function(t){C(r,s,t,n),o(t)})}function D(t,e,r,n){var o=new Z(t);o.subscribe(function(t,e,r){"added"!==t&&"removed"!==t||n(t,e,r)})}function U(t,e,r,n){var o=E(t,e,r);o.forEach(function(e){t.addEventListener(e,n)})}function N(t){return null===t||r(t)||""===t||c(t)&&t===!1}function q(t,e,r){return t.replace(e,r)}function A(t){return/^(GET|POST|PUT|DELETE|HEAD|OPTIONS|PATCH)$/i.test(t)}function L(){return new XMLHttpRequest}function I(t,e,r,n){var o=new yt({method:t,url:e});return r&&(o.addHeader("content-type","application/json"),o.body=r),n&&o.addHeader("Authorization","Bearer "+n),o}function B(t){var e={},r=t.trim().split("\r\n");return r.forEach(function(t){var r=t.split(": ");r[1]&&(e[r[0]]=r[1])}),e}function H(t,e){var r=[];return e.forEach(function(e){u(e[t])&&r.push(e[t])}),r}function V(t,e){var r=new gt;return r.status=t.status,r.headers=B(t.getAllResponseHeaders()),r.body=e.responseType?t.response:t.responseText,r}function M(t,e){var r=L();if(!r)throw new Error("XMLHttpRequest not supported");var n=t.method.toUpperCase(),o=function(){e(V(r,t))};if(t.abort=function(){r.abort()},t.progress&&("GET"===n?r.addEventListener("progress",t.progress):"POST"!==n&&"PUT"!==n||r.upload.addEventListener("progress",t.progress)),r.open(n,t.url,t.async),t.headers)for(var i in t.headers)t.headers.hasOwnProperty(i)&&r.setRequestHeader(i,t.headers[i]);t.responseType&&(r.responseType=t.responseType),t.timeout&&(r.timeout=t.timeout),t.credentials===!0&&(r.withCredentials=!0),r.onload=o,r.onabort=o,r.onerror=o,r.ontimeout=o,r.send(t.body)}function F(t,e){t._result=e;var r=t._stack.next(tt.onResolved);r?r.fn():t._state=Ct.waitOnResolvedCallback}function G(t,e){t._reason=e;var r=t._stack.next(tt.onRejected);r?r.fn():t._state=Ct.waitOnRejectedCallback}function X(t,e,r,n){function o(){try{var n=r(t._result);e._child.resolve(n)}catch(t){e._child.reject(t)}}function i(){try{var r=n(t._reason);e._child.resolve(r)}catch(t){e._child.reject(t)}}var s=u(r),c=u(n);if(e._child=new Rt(t),s&&t._stack.push(tt.onResolved,function(){o()}),c&&t._stack.push(tt.onRejected,function(){i()}),s&&t._state===Ct.waitOnResolvedCallback){var a=t._stack.next(tt.onResolved);a&&a.fn()}else if(c&&t._state===Ct.waitOnRejectedCallback){var a=t._stack.next(tt.onRejected);a&&a.fn()}return e._child}var z,J=Array.isArray,$=function(){function t(){}return t.prototype.set=function(t,e,r){if(!o(t))throw new Error("Name required");if(!o(e))throw new Error("String value required");i(r)||(r=30),document.cookie=t+"="+e+";expires="+a(r)},t.prototype.get=function(t){if(!o(t))throw new Error("Name required");for(var e=document.cookie.split(";"),r=0;r<e.length;r++){var n=e[r].split("=");if(n[0].trim()===t)return n[1].trim()}},t.prototype.has=function(t){if(!o(t))throw new Error("Name required");return void 0!==this.get(t)},t.prototype.delete=function(t){return!!this.has(t)&&(this.set(t,"",-1),!0)},t.prototype.clear=function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var r=t[e].split("=")[0];this.set(r,"",-1)}},t}(),K=function(){function t(t){this._indexedDB=l(),this._dbConfigs=n(t)&&t||[]}return t.prototype.getDbConfig=function(t){return this._dbConfigs.find(function(e){return e.name===t})},t.prototype.openCreateDb=function(t,e){var r=this;return new Promise(function(n,o){var i=r._indexedDB.open(t,e);p(i,o),i.onupgradeneeded=function(e){var n=e.target.result,o=r.getDbConfig(t);o&&J(o.objectStores)&&o.objectStores.forEach(function(t){n.objectStoreNames.contains(t.name)||r.createObjectStore(n,t.name,t.key,t.indexes)})},i.onsuccess=function(e){r._currentDb=e.target.result,r._currentDbName=t,r._currentConfig=r.getDbConfig(t),n(r._currentDb)}})},t.prototype.closeDb=function(){this._currentDb&&"close"in this._currentDb&&this._currentDb.close()},t.prototype.deleteDb=function(t){var e=this;return new Promise(function(r,n){e._currentDbName===t&&e.closeDb();var o=e._indexedDB.deleteDatabase(t);p(o,n),o.onsuccess=function(t){r(t)}})},t.prototype.createObjectStore=function(t,e,r,n){var o=t.createObjectStore(e,r);n&&n.forEach(function(t){var e=t.definition||{unique:!1};o.createIndex(t.name,t.key,e)})},t.prototype.getObjectStore=function(t,e,r){var n=this._currentDb.transaction([t],e);return r&&p(n,r),n.objectStore(t)},t.prototype.insert=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");if(r._currentConfig&&r._currentConfig.created){var i=Date.now();e.created=i,e.modified=i}var s=r.getObjectStore(t,"readwrite",o);if(s){var u=s.add(e);p(u,o),u.onsuccess=function(t){n(t.target.result)}}})},t.prototype.update=function(t,e,r){var n=this;return new Promise(function(o,i){if(!n._currentDb)throw new Error("Require a connection opened");var s=n.getObjectStore(t,"readwrite",i),u=s.get(e);p(u,i),u.onsuccess=function(t){var e=t.target.result;if(e){n._currentConfig&&n._currentConfig.created&&(r.modified=Date.now());var u=s.put(r);p(u,i),u.onsuccess=function(){o(r)}}}})},t.prototype.delete=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");var i=r.getObjectStore(t,"readwrite",o),s=i.delete(e);p(s,o),s.onsuccess=function(t){n(t)}})},t.prototype.count=function(t){var e=this;return new Promise(function(r,n){if(!e._currentDb)throw new Error("Require a connection opened");var o=e.getObjectStore(t,"readonly",n),i=o.count();p(i,n),i.onsuccess=function(t){r(t.target.result)}})},t.prototype.getAll=function(t){var e=this;return new Promise(function(r,n){if(!e._currentDb)throw new Error("Require a connection opened");var o=[],i=e.getObjectStore(t,"readonly",n),s=i.count();p(s,n),s.onsuccess=function(t){var e=t.target.result,s=i.openCursor();p(s,n),s.onsuccess=function(t){var n=t.target.result;if(n){var i=n.value;o.push(i),o.length===e?r(o):n.continue()}else r(o)}}})},t.prototype.getOne=function(t,e){var r=this;return new Promise(function(n,o){if(!r._currentDb)throw new Error("Require a connection opened");var i=r.getObjectStore(t,"readonly",o),s=i.get(e);p(s,o),s.onsuccess=function(t){n(t.target.result)}})},t}(),Q=function(){function t(t){this._strategy=o(t)&&/^(local|session)$/i.test(t)?t:"local","local"===this._strategy?this._storage=localStorage:this._storage=sessionStorage}return t.prototype.set=function(t,e){try{var r=s(e)?JSON.stringify(e):e;this._storage[t]=r}catch(t){}},t.prototype.get=function(t){var e=this._storage[t],r=f(e);return r?r:e},t.prototype.has=function(t){return void 0!==this._storage[t]},t.prototype.remove=function(t){return!!this.has(t)&&(this._storage.removeItem(t),!0)},t.prototype.getValues=function(){for(var t=[],e=0;e<this._storage.length;e++){var r=this.get(this._storage.key(e));t.push(r)}return t},t.prototype.getKeys=function(){return Object.keys(this._storage)},t.prototype.clear=function(){this._storage.clear()},t}(),W=function(){var t={},e=new Q,r=function(){function r(){}return Object.defineProperty(r.prototype,"length",{get:function(){return Object.keys(t).length},enumerable:!0,configurable:!0}),r.prototype.has=function(e){return t.hasOwnProperty(e)},r.prototype.store=function(e,r){t[e]=r},r.prototype.retrieve=function(e){if(this.has(e))return t[e]},r.prototype.remove=function(e){return!!this.has(e)&&(delete t[e],!0)},r.prototype.clear=function(){t={}},r.prototype.save=function(r){e.set(r,t)},r.prototype.restore=function(r){var n=e.get(r);return!!n&&(t=n,!0)},r}();return r}(),Y=function(){function t(t,e){function r(t){o._subscribers.forEach(function(e){e(t)})}var n=t[e],o=this;this._subscribers=[],Object.defineProperty(t,e,{get:function(){return n},set:function(t){n=t,r(t)},enumerable:!0,configurable:!0})}return t.prototype.subscribe=function(t){this._subscribers.push(t)},t.prototype.unsubscribe=function(t){var e=this._subscribers.indexOf(t);return e!==-1&&(this._subscribers.splice(e,1),!0)},t}(),Z=function(){function t(t){function e(t,e,n){r._subscribers.forEach(function(r){r(t,e,n)})}var r=this;if(!J(t))throw new TypeError("Array required");this._subscribers=[],this._array=t,t.push=function(){for(var t=0;t<arguments.length;t++){var r=arguments[t],n=this.length;Array.prototype.push.call(this,r),e("added",r,n)}return this.length},t.unshift=function(){for(var t=0;t<arguments.length;t++){var e=arguments[t];this.splice(t,0,e)}return this.length},t.splice=function(t,r){for(var n=this,o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];if(!i(t)||!i(r))return[];for(var u=[],c=t+r,a=t;a<c;a++){var f=Array.prototype.splice.call(this,t,1)[0];u.push(f),e("removed",f,a)}return o.forEach(function(r,o){Array.prototype.splice.call(n,t,0,r),e("added",r,o),t++}),u},t.shift=function(){if(this.length>-1){var t=Array.prototype.shift.call(this);return e("removed",t,0),t}},t.pop=function(){var t=this.length-1;if(t>-1){var r=Array.prototype.pop.call(this);return e("removed",r,t),r}},t.sort=function(t){return Array.prototype.sort.call(this,t),e("sorted",this,null),this},t.filter=function(t){var r=[];return this.forEach(function(e){t(e)===!0&&r.push(e)}),e("filtered",r,null),r},t.resetFilter=function(){return e("filtered",this,null),this}}return t.prototype.subscribe=function(t){this._subscribers.push(t)},t.prototype.unsubscribe=function(t){var e=this._subscribers.indexOf(t);return e!==-1&&(this._subscribers.splice(e,1),!0)},t}();!function(t){t[t.CheckBox=0]="CheckBox",t[t.Radio=1]="Radio",t[t.Input=2]="Input",t[t.Range=3]="Range",t[t.Select=4]="Select",t[t.TextArea=5]="TextArea",t[t.Other=6]="Other"}(z||(z={}));var tt,et=function(){function t(t,e){if(!o(t))throw new Error("Name required (target form element name/source property name)");this.name=t,this.validators=[];var r=o(e)?e:"valuechanged";this.setUpdateType(r)}return t.prototype.setUpdateType=function(t){if(!o(t))throw new Error("Update type required");if(!v(t))throw new Error("Invalid update type (valuechanged|lostfocus)");return this.updateType=t,this},t.prototype.addValidator=function(t){return this.validators.push(t),this},t}(),rt=function(){function t(t,e,r,n){this.validationType=o(t)&&g(t)?t:"submit",this.formElementConfigs={},this.showErrorMessages=!c(e)||e,this.cssClassOnSuccess=!c(r)||r,this.cssClassOnError=!c(n)||n}return t.prototype.addFormElementConfig=function(t,e,r){var n=new et(t,r);return J(e)&&e.forEach(function(t){n.addValidator(t)}),this.formElementConfigs[n.name]=n,this},t.prototype.getFormElementConfig=function(t){if(this.formElementConfigs.hasOwnProperty(t))return this.formElementConfigs[t]},t}(),nt=function(){function t(t,e,r,n,o){this.formBinding=t,this.element=e,this.bindedName=r,this.formElementConfig=n,this.formConfig=o,this._subscribers=[],this._elementType=m(e)}return t.prototype._raiseStateChanged=function(t,e){this._subscribers.forEach(function(r){r(t,e)})},t.prototype._checkState=function(t,e){var r=t[0],n=o(r);this.hasError===n&&this.firstError===r||(this.hasError=n,this.firstError=r,this.errors=t,this._raiseStateChanged(this.element,t),e())},t.prototype.onStateChanged=function(t){this._subscribers.push(t)},t}(),ot=function(t){function r(e,r,n,o,i,s,u,c){var a=t.call(this,e,r,n,o,i)||this;return a.source=s,a.sourceValue=u,a.type=c,a._bind(a.element,a._elementType,a.source,a.bindedName,a.sourceValue,a.type,a.formElementConfig,a.formConfig),a}return e(r,t),r.prototype._bind=function(t,e,r,n,o,i,s,u){var c,a=this;U(t,e,s.updateType,function(t){var e="boolean"===i?t.target.checked:b(i,t.target.value);r[n]=e}),P(r,n,t,e,function(e){if(c||a.formBinding.canValidate){var r=R(e,s.validators);a._checkState(r,function(){j(t,r,u.showErrorMessages,u.cssClassOnSuccess,u.cssClassOnError)}),c=!0}}),C(t,i,o,e)},r.prototype.validate=function(){var t=this.source[this.bindedName];return this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(nt),it=function(t){function r(e,r,n,o,i,s,u){var c=t.call(this,e,r,n,o,i)||this;return c.source=s,c.sourceValue=u,c.type=u[0]?typeof u[0]:"string",c._bind(c.element,c._elementType,c.sourceValue,c.type,c.formElementConfig,c.formConfig),c}return e(r,t),r.prototype._bind=function(t,e,r,n,o,i){var s,u=this;U(t,e,o.updateType,function(t){var e="boolean"===n?t.target.checked:b(n,t.target.value),o=r.indexOf(e);o===-1?r.push(e):r.splice(o,1)}),D(r,t,e,function(c,a,f){if(T(r,n,t,e),s||u.formBinding.canValidate){var h=R(a,o.validators);u._checkState(h,function(){j(t,h,i.showErrorMessages,i.cssClassOnSuccess,i.cssClassOnError)}),s=!0}}),T(r,n,t,e)},r.prototype.validate=function(){var t=this.source[this.bindedName];return this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(nt),st=function(t){function r(e,r,n,o,i){var s=t.call(this,e,r,n,o,i)||this;return s._bind(s.element,s._elementType,s.formElementConfig,s.formConfig),s}return e(r,t),r.prototype._bind=function(t,e,r,n){var o,i=this;U(t,e,r.updateType,function(e){if(o||i.formBinding.canValidate){var s=S(t,i._elementType);i.value=s;var u=R(s,r.validators);i._checkState(u,function(){j(t,u,n.showErrorMessages,n.cssClassOnSuccess,n.cssClassOnError)}),o=!0}})},r.prototype.validate=function(){var t=S(this.element,this._elementType);return this.value=t,this.errors=R(t,this.formElementConfig.validators),this.hasError=this.errors.length>0,this.errors},r}(nt),ut=function(){function t(t,e,r){this.element=t,this.message=e,this.value=r}return t}(),ct=function(){function t(t,e,r,n){this.hasError=t,this.errors=e,this.form=r,this.source=n}return t}(),at=function(){function t(t,e,r){this._subscribers=[],this._stateSubscribers=[],this._bindings=[],this.submitted=!1;var o=y(t);if(!o)throw new Error("No element found for the form");this.form=o,this.source=e,this.formConfig=n(r)?r:new rt,this.validationType=r.validationType,this._bind(o,e,this.formConfig),this._bindSubmit(o,e,this.formConfig)}return Object.defineProperty(t.prototype,"canValidate",{get:function(){return this.submitted||"valuechanged"===this.validationType},enumerable:!0,configurable:!0}),t.prototype._bind=function(t,e,r){for(var n=this,o=0;o<t.elements.length;o++){var i=t.elements[o];if("submit"!==i.type){var s=_(i),u=x(i);if(s&&u){var c=r.getFormElementConfig(u);if(e&&e.hasOwnProperty(u)){var a=e[u],f=typeof a;if(c||(c=new et(u),r.formElementConfigs[u]=c),"string"===f||"number"===f||"boolean"===f){var h=new ot(this,i,u,c,r,e,a,f);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}else if(J(a)){var h=new it(this,i,u,c,r,e,a);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}}else if(et){var h=new st(this,i,u,c,r);h.onStateChanged(function(t,e){n._raiseStateChanged(t,e)}),this._bindings.push(h)}}}}},t.prototype._validateAll=function(t,e,r){var n=!1,o=[],i={};this._bindings.forEach(function(t){if(!i.hasOwnProperty(t.bindedName)){var e=t instanceof ot?t.sourceValue:t.value,s=t.validate();s.length>0&&(n=!0,o.push(new ut(t.element,s[0],e))),j(t.element,s,r.showErrorMessages,r.cssClassOnSuccess,r.cssClassOnError),i[t.bindedName]="validated"}}),this.submitted=!0;var s=new ct(n,o,this.form,this.source);this._raise(s)},t.prototype._bindSubmit=function(t,e,r){var n=this;t.addEventListener("submit",function(o){o.preventDefault(),n._validateAll(t,e,r)})},t.prototype._raise=function(t){this._subscribers.forEach(function(e){e(t)})},t.prototype._raiseStateChanged=function(t,e){this._validateAll(this.form,this.source,this.formConfig),this._stateSubscribers.forEach(function(r){r(t,e)})},t.prototype.onStateChanged=function(t){this._stateSubscribers.push(t)},t.prototype.onSubmit=function(t){this._subscribers.push(t)},t}(),ft=function(){function t(){}return t.required=function(t){return new ht(t)},t.minLength=function(t,e){return new lt(t,e)},t.maxLength=function(t,e){return new pt(t,e)},t.pattern=function(t,e){return new dt(t,e)},t.custom=function(t,e){return new vt(t,e)},t}(),ht=function(t){function r(e){var r=t.call(this)||this;return r.message=o(e)?e:"This field is required.",r}return e(r,t),r.prototype.validate=function(t){return N(t)?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ft),lt=function(t){function r(e,r){var n=t.call(this)||this;return n.minLength=i(e)?e:3,n.message=o(r)?r:q("Please enter at least than {0} characters.","{0}",e),n}return e(r,t),r.prototype.validate=function(t){return!N(t)&&t.length<this.minLength?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ft),pt=function(t){function r(e,r){var n=t.call(this)||this;return n.maxLength=i(e)?e:30,n.message=o(r)?r:q("Please enter no more than {0} characters.","{0}",e),n}return e(r,t),r.prototype.validate=function(t){return!N(t)&&t.length>this.maxLength?(this.error=this.message,!1):(this.error=void 0,!0)},r}(ft),dt=function(t){function r(e,r){var n=t.call(this)||this;return n.pattern=e,n.message=o(r)?r:"Please fix this field.",n}return e(r,t),r.prototype.validate=function(t){return N(t)||this.pattern.test(t)?(this.error=void 0,!0):(this.error=this.message,!1)},r}(ft),vt=function(t){function r(e,r){var n=t.call(this)||this;return n.fn=e,n.message=o(r)?r:"Please fix this field.",n}return e(r,t),r.prototype.validate=function(t){return N(t)||this.fn(t)?(this.error=void 0,!0):(this.error=this.message,!1)},r}(ft),gt=function(){function t(){}return Object.defineProperty(t.prototype,"isSuccessStatusCode",{get:function(){return this.status>=200&&this.status<=299},enumerable:!0,configurable:!0}),t}(),yt=function(){function t(t){if(t.method){if(!A(t.method))throw new Error("Invalid http method (GET|POST|PUT|DELETE|HEAD|OPTIONS|PATCH)");this.method=t.method}else this.method="GET";if(!o(t.url))throw new Error("Url required");if(this.url=t.url,this.headers={},t.headers)for(var e in t.headers)t.headers.hasOwnProperty(e)&&this.addHeader(e,t.headers[e]);this.async=!c(t.async)||t.async,this.body=t.body,t.responseType&&(this.responseType=t.responseType),u(t.progress)&&(this.progress=t.progress),i(t.timeout)&&(this.timeout=t.timeout),c(t.credentials)&&(this.credentials=t.credentials)}return t.prototype.addHeader=function(t,e){return this.headers[t]=e,this},t.prototype.setResponseType=function(t){return this.responseType=t,this},t}(),mt=function(){function t(){this.interceptors=[]}return t.prototype._intercept=function(t,e,r,n){function o(t){t(e,function(t){t?(u++,u<s?o(i[u]):r()):n()})}var i=H(t,this.interceptors),s=i.length,u=0;s>0?o(i[0]):r&&r()},t.prototype.load=function(t,e,r){if(!o(t))throw new Error("Url required");var n=new yt({url:t});M(n,function(t){200===t.status?e(t.body):r&&r(t)})},t.prototype.send=function(t){var e=this;return new Promise(function(r,n){e._intercept("before",t,function(){try{M(t,function(t){e._intercept("after",t,function(){t.isSuccessStatusCode?r(t):n(t)},function(){n(t)})})}catch(t){n(t)}},function(){var t=new gt;t.status=401,n(t)})})},t.prototype.get=function(t,e){var r=I("GET",t,null,e);return this.send(r)},t.prototype.post=function(t,e,r){var n=I("POST",t,e,r);return this.send(n)},t.prototype.put=function(t,e,r){var n=I("PUT",t,e,r);return this.send(n)},t.prototype.delete=function(t,e){var r=I("DELETE",t,null,e);return this.send(r)},t}(),bt=function(){function t(){this._cache={}}return t.prototype.getSubscribers=function(t){return this._cache[t]},t.prototype.isRegistered=function(t){return this._cache.hasOwnProperty(t)},t.prototype.subscribe=function(t,e){if(r(t))throw new Error("Event required");if(r(e))throw new Error("Subscriber required");this.isRegistered(t)||(this._cache[t]=[]),this._cache[t].push(e)},t.prototype.publish=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.isRegistered(t)&&this._cache[t].forEach(function(t){t.apply(void 0,e)})},t.prototype.unsubscribe=function(t,e){if(r(t))throw new Error("Event required");if(this.isRegistered(t)){if(!u(e))return delete this._cache[t],!0;var n=this._cache[t].indexOf(e);if(n!==-1)return this._cache[t].splice(n,1),!0}return!1},t.prototype.clear=function(){this._cache={}},t}(),_t=function(){function t(t){if(r(t))throw new Error("Config required");if(r(t.clientId))throw new Error("clientId required");if(r(t.redirectUrl))throw new Error("redirectUrl required");this._http=new mt,this.clientId=t.clientId,this.redirectUrl=t.redirectUrl}return t.prototype.getCodeUrl=function(){if(r(this.authUrl))throw new Error("authUrl required");return this.authUrl+"?client_id="+this.clientId+"&redirect_uri="+this.redirectUrl+"&scope="+this.scope+"&response_type=code"},t.prototype.getProfile=function(t){var e=this;if(r(t))throw new Error("access_token required");if(r(this.profileUrl))throw new Error("profileUrl required");var n=r(this.fields)?this.profileUrl:this.profileUrl+"?fields="+this.fields;return new Promise(function(r,o){e._http.get(n,t).then(function(t){r(t.body)}).catch(function(t){o(t)})})},t.prototype.getTokenUrl=function(){if(r(this.authUrl))throw new Error("authUrl required");return this.authUrl+"?client_id="+this.clientId+"&redirect_uri="+this.redirectUrl+"&scope="+this.scope+"&response_type=token"},t}(),wt=function(t){function r(e){var r=t.call(this,e)||this;return r.scope=e.scope||"public_profile,email",r.authUrl=e.authUrl||"https://www.facebook.com/dialog/oauth",r.profileUrl=e.profileUrl||"https://graph.facebook.com/me",r.fields=e.fields||"id,name,email",r}return e(r,t),r}(_t),Et=function(t){function r(e){var r=t.call(this,e)||this;return r.scope=e.scope||"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",r.authUrl=e.authUrl||"https://accounts.google.com/o/oauth2/auth",r.profileUrl=e.profileUrl||"https://www.googleapis.com/oauth2/v1/userinfo",r}return e(r,t),r}(_t);!function(t){t[t.onResolved=0]="onResolved",t[t.onRejected=1]="onRejected"}(tt||(tt={}));var Ct,St=function(){function t(t,e){this.type=t,this.fn=e}return t}(),Tt=function(){function t(){this._stack=[]}return t.prototype._getNextItemIndex=function(t){for(var e=this._stack.length,r=0;r<e;r++){var n=this._stack[r];if(n.type===t)return r}return-1},t.prototype._splice=function(t){this._stack.splice(0,t)},t.prototype.clear=function(){this._stack=[]},t.prototype.push=function(t,e){this._stack.push(new St(t,e))},t.prototype.next=function(t){var e=this._getNextItemIndex(t);return e!==-1?this._splice(e):this.clear(),this._stack.shift()},t}();!function(t){t[t.completed=0]="completed",t[t.waitOnResolvedCallback=1]="waitOnResolvedCallback",t[t.waitOnRejectedCallback=2]="waitOnRejectedCallback"}(Ct||(Ct={}));var Ot=function(){function t(){}return t}(),kt=function(t){function r(e){var r=t.call(this)||this;r._stack=new Tt;try{u(e)&&e(function(t){r.resolve(t)},function(t){r.reject(t)})}catch(t){r.reject(t)}return r}return e(r,t),r.prototype.resolve=function(t){F(this,t)},r.prototype.reject=function(t){G(this,t)},r.prototype.then=function(t,e){return X(this,this,t,e)},r.prototype.catch=function(t){return X(this,this,null,t)},r.all=function(t){for(var e=[],n=!1,o=t.length,i=0,s=new r,u=0;u<o;u++){var c=t[u];try{c.then(function(t){n||(e.push(t),i++,i===o&&(n=!0,s.resolve(e)))},function(t){n||(n=!0,s.reject(t))})}catch(t){n=!0,s.reject(t)}}return s},r.race=function(t){for(var e=!1,n=t.length,o=new r,i=0;i<n;i++){var s=t[i];try{s.then(function(t){e||(e=!0,o.resolve(t))},function(t){e||(e=!0,o.reject(t))})}catch(t){e=!0,o.reject(t)}}return o},r}(Ot),Rt=function(t){function r(e){var r=t.call(this)||this;return r._root=e,r}return e(r,t),r.prototype.resolve=function(t){F(this._root,t)},r.prototype.reject=function(t){G(this._root,t)},r.prototype.then=function(t,e){return X(this._root,this,t,e)},r.prototype.catch=function(t){return X(this._root,this,null,t)},r}(Ot);t.Cache=W,t.FormBinding=at,t.CustomValidator=vt,t.FormConfig=rt,t.FormElementConfig=et,t.MaxLengthValidator=pt,t.MinLengthValidator=lt,t.PatternValidator=dt,t.RequiredValidator=ht,t.Validator=ft,t.FormSubmittedResponse=ct,t.FormElementError=ut,t.Http=mt,t.HttpRequest=yt,t.HttpResponse=gt,t.Messenger=bt,t.Observable=Y,t.ObservableArray=Z,t.FacebookAuth=wt,t.GoogleAuth=Et,t.OAuth=_t,t.TSPromise=kt,t.IndexedDBService=K,t.StorageService=Q,t.CookieService=$,t.supportStorage=h,Object.defineProperty(t,"__esModule",{value:!0})});